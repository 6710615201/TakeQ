{% extends 'base.html' %}

{% block content %}
	<div class="d-flex justify-content-between align-items-center mb-3">
		<h2>Room: {{ room.name }} ({{ room.code }})</h2>

		<div>
			{# Show create-quiz link and delete button to owner/admin only #}
			{% if request.user == room.owner or role == 'owner' or role == 'admin' %}
				<a href="{% url 'create_quiz:quiz_create' %}?next={{ request.path }}"
				class="btn btn-primary btn-sm me-2">
					สร้าง quiz ใหม่
				</a>

				<form method="post"
					action="{% url 'room:delete' room.code %}"
					onsubmit="return confirm('Delete this room? This action cannot be undone.');"
					style="display:inline;">
					{% csrf_token %}
					<button type="submit" class="btn btn-danger btn-sm">
						ลบห้อง
					</button>
				</form>
			{% endif %}
		</div>
	</div>


	<p>{{ room.description }}</p>

	<p>Owner: {{ room.owner }}</p>

	<h3>Members</h3>
	<ul>
	{% for m in members %}
		<li>{{ m.user }} — {{ m.role }}</li>
	{% empty %}
		<li>No members</li>
	{% endfor %}
	</ul>
	
	<h3>Assignments</h3>
	<ul>
	{% for a in assignments %}
		<li>{{ a.quiz.title }} — assigned at {{ a.assigned_at }}</li>
	{% empty %}
		<li>No quizzes assigned</li>
	{% endfor %}
	</ul>
{% endblock %}
