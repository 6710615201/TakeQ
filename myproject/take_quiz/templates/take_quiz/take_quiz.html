{% extends "base.html" %}

{% block title %}<title>Take: {{ quiz.title }}</title>{% endblock %}

{% block content %}
<h2>{{ quiz.title }}</h2>
<p>{{ quiz.description }}</p>

<form method="post" action="{% url 'take_quiz:submit_quiz' attempt.id %}">
  {% csrf_token %}

  {% for q in questions %}
    <div class="card my-3">
      <div class="card-body">
        <h5>Q{{ forloop.counter }}. {{ q.text }}</h5>

        {% if q.qtype == "mcq" %}
          {% for c in q.choices.all %}
            <div class="form-check">
              <input class="form-check-input" type="radio"
                     name="question_{{ q.id }}"
                     id="choice_{{ c.id }}"
                     value="{{ c.id }}">
              <label class="form-check-label" for="choice_{{ c.id }}">
                {{ c.text }}
              </label>
            </div>
          {% endfor %}

        {% elif q.qtype == "short" %}
          <div class="mb-2">
            <label for="qa_{{ q.id }}" class="form-label">Your answer</label>
            <textarea id="qa_{{ q.id }}"
                      name="question_{{ q.id }}"
                      class="form-control"
                      rows="4"
                      maxlength="2000"
                      placeholder="Type your answer here..."></textarea>
            <div class="form-text">This answer will be saved for manual review or auto-grading if enabled.</div>
          </div>

        {% else %}
          <div class="text-muted">Unknown question type.</div>
        {% endif %}

      </div>
    </div>
  {% endfor %}

  <div class="d-flex justify-content-between align-items-center">
    <a class="btn btn-secondary" href="{% url 'take_quiz:quiz_list' %}">Back</a>
    <button class="btn btn-success" type="submit">Submit</button>
  </div>
</form>
{% endblock %}
